import nodemailer from "nodemailer";
import {
  Document,
  Paragraph,
  Header,
  Packer,
  HeadingLevel,
  Footer,
  TextRun,
  AlignmentType,
  TableRow,
  TableCell,
  Table,
  VerticalAlign,
  TextDirection,
  WidthType,
  TableLayout,
  TableLayoutType,
  HeightRule,
  BorderStyle,
  Media,
  ImageRun,
  PageNumber,
  Tab,
} from "docx";
import path from "path";
import bodyReq from "../../config/http-common.js";
import actaData from "../../libs/acta.js";
// import LogoUNAC from "../../../src/img/logo-unac.png"
import moment from "moment";
import * as fs from "fs/promises";
import * as fss from "fs";
// import * as jsPDF from "jspdf"

// Cambiar los valores de user y pass
const user = "actasconsejofi@unac.edu.co";
const pass = "lvsowhhhwtxllmxh";

// RUTA PRINCIPAL
export const sendEmailPdf = async (req, res) => {
  // DESESTRUCTURAMOS EL CUERPO DE LA PETICIÓN
  const { token, ref, name, to, subject, bodyEmail } = req.body;
  const toArr = to.split(",");

  // INICIALIZAMOS UNA PLANTILLA DE AXIOS CON UNA CONFIGURACIÓN PERSONALIZADA
  const httpCommon = bodyReq(token);

  // REALIZAMOS LA PETICIÓN A LA API
  const response = await httpCommon.get(`actas/referencia/${ref}`);

  // POR MEDIO DE LA DESESTRUCTURACIÓN, PUEDES OBTENER LOS DATOS INDIVIDUALES DE LA ACTA
  const {
    numeroRef,
    lugar,
    modalidad,
    miembrosPresentes,
    miembrosInvitados,
    miembrosAusentes,
    cronograma,
    horaInicio,
    horaFinal,
    fechaCreacion,
    articulos,
  } = response.data;

  // ESTAS IMPRESIONES DE CONSOLA SON OPCIONALES, PERO NECESARIAS PARA LA COMPRENSIÓN DEL FUNCIONAMIENTO DEL CONTROLADOR
  // console.log(numeroRef, lugar, modalidad);

  // PARA RECORRER LOS MIEMBROS DEL ACTA, UTILIZAR Map()
  // miembrosPresentes.map((presente, index) => {
  //   console.log(
  //     `Miembro #: ${index}\nNombre:${presente.nombre}\nApellido:${presente.apellido}\n--------------------------`
  //   );
  // });

  // --- DOCX ---
  const rows = [
    // DEFINE LAS FILAS QUE HAYAN EN LA TABLA
    // ESTA PRIMERA FILA SERÁ NUESTROS ENCABEZADOS
    new TableRow({
      children: [
        // CREAMOS LAS CELDAS
        // ENCABEZADO PARA NOMBRE
        new TableCell({
          children: [
            // RELLENAMOS LA CELDA CON UN TITULO, PARRAFO, ENTRE OTROS
            new Paragraph({
              text: "N°",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        // ENCABEZADO PARA APELLIDO
        new TableCell({
          children: [
            new Paragraph({
              text: "Nombre Completo",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        // ENCABEZADO PARA CARGO
        new TableCell({
          children: [
            new Paragraph({
              text: "Cargo",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
      ],
    }),
  ];

  const rowsHomo = [
    new TableRow({
      children: [
        new TableCell({
          children: [
            new Paragraph({
              text: "Materia Aprobada",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Nota Final",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Materia Equivalente",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Créditos",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
      ],
    }),
  ];

  const rowsAutrz = [
    new TableRow({
      children: [
        new TableCell({
          children: [
            new Paragraph({
              text: "N°",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Nombre del aspirante",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Tipo de documento",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "N° de documento",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Programa profesional",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
        new TableCell({
          children: [
            new Paragraph({
              text: "Código SNIES",
              alignment: AlignmentType.CENTER,
              style: "Strong",
            }),
          ],
        }),
      ],
    }),
  ];

  // PARA RECORRER LOS MIEMBROS DEL ACTA, UTILIZAR Map()
  miembrosPresentes.map((presente, index) => {
    console.log(
      `Miembro #: ${index}\nNombre:${presente.nombre}\nApellido:${presente.apellido}\n--------------------------`
    );
  });

  moment.locale("es");
  const horaInicioFormat = moment(horaInicio).format("h:mm a");
  const horaFinalFormat = moment(horaFinal).format("h:mm a");
  const fechaCreacionPrologoFormat = moment(fechaCreacion).format(
    `dddd DD [de] MMMM [de] YYYY`
  );

  const lugarTexto =
    lugar === "LDS"
      ? "Laboratorio de sistemas (LDS)"
      : lugar === "LADSIF"
      ? "Laboratorio de análisis de datos e investigación (LADSIF)"
      : lugar
      ? lugar
      : "...";

  const imageData =
    "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";

  // FUNCIÓN QUE RECOPILA LOS MIEMBROS Y LOS AGREGA A LAS FILAS DE LA TABLA
  function createMembersArrayForTablePresent() {
    return miembrosPresentes.map((miembro, index) => {
      return new TableRow({
        children: [
          new TableCell({
            children: [
              // CELDA PARA NOMBRE
              new Paragraph({
                text: (index + 1).toString(),
              }),
            ],
          }),
          // CELDA PARA APELLIDO
          new TableCell({
            children: [
              new Paragraph({
                text: `${miembro.nombre} ${miembro.apellido}`,
              }),
            ],
          }),
          // CELDA PARA CARGO
          new TableCell({
            children: [
              new Paragraph({
                text: miembro.cargo,
              }),
            ],
          }),
        ],
      });
    });
  }
  function createMembersArrayForTableAusent() {
    return miembrosAusentes.map((miembro, index) => {
      return new TableRow({
        children: [
          new TableCell({
            children: [
              // CELDA PARA NOMBRE
              new Paragraph({
                text: (index + 1).toString(),
              }),
            ],
          }),
          // CELDA PARA APELLIDO
          new TableCell({
            children: [
              new Paragraph({
                text: `${miembro.nombre} ${miembro.apellido}`,
              }),
            ],
          }),
          // CELDA PARA CARGO
          new TableCell({
            children: [
              new Paragraph({
                text: miembro.cargo,
              }),
            ],
          }),
        ],
      });
    });
  }
  function createMembersArrayForTableInvit() {
    return miembrosInvitados.map((miembro, index) => {
      return new TableRow({
        children: [
          new TableCell({
            children: [
              // CELDA PARA NOMBRE
              new Paragraph({
                text: (index + 1).toString(),
              }),
            ],
          }),
          // CELDA PARA APELLIDO
          new TableCell({
            children: [
              new Paragraph({
                text: `${miembro.nombre} ${miembro.apellido}`,
              }),
            ],
          }),
          // CELDA PARA CARGO
          new TableCell({
            children: [
              new Paragraph({
                text: miembro.cargo,
              }),
            ],
          }),
        ],
      });
    });
  }

  function createArticuloHomologa() {
    return articulos.map((articulo) => {
      return new TableRow({
        children: [
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.materiaAprobada,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.nota,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.materiaEquivalente,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.credito,
              }),
            ],
          }),
        ],
      });
    });
  }

  function createAutoriza() {
    return articulos.map((articulo, index) => {
      return new TableRow({
        children: [
          new TableCell({
            children: [
              new Paragraph({
                text: (index + 1).toString(),
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.nombreAspirante,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.tipoDocumento,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.noDocumento,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.programaEstudiante,
              }),
            ],
          }),
          new TableCell({
            children: [
              new Paragraph({
                text: articulo.codigoSnies,
              }),
            ],
          }),
        ],
      });
    });
  }

  let autoRowsPresent = createMembersArrayForTablePresent();
  let autoRowsAusent = createMembersArrayForTableAusent();
  let autoRowsInvit = createMembersArrayForTableInvit();
  let autoRowsHomologa = createArticuloHomologa();
  let autoRowsAutoriza = createAutoriza();

  const fixedRowsHomologa = rowsHomo.concat(autoRowsHomologa);
  const fixedRowsAutoriza = rowsAutrz.concat(autoRowsAutoriza);
  const fixedRowsPresent = rows.concat(autoRowsPresent);
  const fixedRowsAusent = rows.concat(autoRowsAusent);
  const fixedRowsInvit = rows.concat(autoRowsInvit);

  // USO DE TABLAS
  const tablePresent = new Table({
    rows: fixedRowsPresent,
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    alignment: AlignmentType.CENTER,
  });
  const tableAusent = new Table({
    rows: fixedRowsAusent,
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    alignment: AlignmentType.CENTER,
  });
  const tableInvit = new Table({
    rows: fixedRowsInvit,
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    alignment: AlignmentType.CENTER,
  });
  const tableHomologa = new Table({
    rows: fixedRowsHomologa,
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    alignment: AlignmentType.CENTER,
  });

  const tableAutoriza = new Table({
    rows: fixedRowsAutoriza,
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    alignment: AlignmentType.CENTER,
  });

  const firma = new Table({
    width: {
      size: 100,
      type: WidthType.AUTO,
    },
    rows: [
      new TableRow({
        children: [
          new TableCell({
            width: {
              size: 50,
              type: WidthType.PERCENTAGE,
            },
            borders: {
              top: {
                style: BorderStyle.SINGLE,
                size: 3,
                color: "000000",
              },
              left: {
                style: BorderStyle.NONE,
              },
              bottom: {
                style: BorderStyle.NONE,
              },
              right: {
                style: BorderStyle.NONE,
              },
            },
            children: [
              new Paragraph({
                text: actaData.FIRMAS.JFNM.nombre,
                style: "Strong",
              }),
              new Paragraph({
                text: actaData.FIRMAS.JFNM.cargo,
                style: "Strong",
              }),
            ],
          }),
          new TableCell({
            width: {
              size: 50,
              type: WidthType.PERCENTAGE,
            },
            borders: {
              top: {
                style: BorderStyle.SINGLE,
                size: 3,
                color: "000000",
              },
              left: {
                style: BorderStyle.NONE,
              },
              bottom: {
                style: BorderStyle.NONE,
              },
              right: {
                style: BorderStyle.NONE,
              },
            },
            children: [
              new Paragraph({
                text: actaData.FIRMAS.OJD.nombre,
                style: "Strong",
              }),
              new Paragraph({
                text: actaData.FIRMAS.OJD.cargo,
                style: "Strong",
              }),
            ],
          }),
        ],
      }),
    ],
  });

  const parrafosArticulos = articulos.map((voto, index) => {
    const parrafos = [
      new Paragraph({
        children: [
          new TextRun({
            text: `Articulos ${(index + 1).toString()} ${voto.titulo}_${
              voto.nombreAspirante
            }`,
            bold: true,
          }),
        ],
        alignment: AlignmentType.CENTER,
      }),
      new Paragraph({
        children: [
          new TextRun({
            text: `Aprobar la solicitud de ${voto.titulo} del estudiante ${voto.nombreAspirante}, identificado con ${voto.tipoDocumento} numero ${voto.noDocumento}`,
            alignment: AlignmentType.JUSTIFIED,
          }),
        ],
      }),
    ];

    // Condicionales para agregar tablas adicionales según el título del artículo
    if (voto.titulo === "Homologación Interna") {
      parrafos.push(tableHomologa); // Agregar tabla de homologación
    } else if (voto.titulo === "Homologación Externa") {
      parrafos.push(tableAutoriza); // Agregar tabla de autorización de título
    } else if (
      voto.titulo === "Autorización de expedición de títulos académicos"
    ) {
      parrafos.push(tableAutoriza); // Agregar tabla de autorización de título
    }

    return parrafos;
  });

  // const image = new ImageRun({
  //   data: fss.readFileSync("../../libs/img/logo-unac.jpg").toString("base64"),
  //   transformation: {
  //     width: 100,
  //     height: 100,
  //   },
  // });

  // const imageBase64 = new ImageRun({
  //   data: Uint8Array.from(atob(imageData), (c) => c.charCodeAt(0)),
  //   transformation: {
  //     width: 200,
  //     height: 100,
  //   },
  //   alignment: AlignmentType.START,
  // });

  // USO BÁSICO
  const doc = new Document({
    sections: [
      {
        properties: {},
        headers: {
          default: new Header({
            children: [
              // image,
              // imageBase64,
              new Paragraph({
                text: actaData.TITULO,
                alignment: AlignmentType.CENTER,
                style: "Strong",
              }),
              new Paragraph({
                text: actaData.SUBTITULO,
                alignment: AlignmentType.CENTER,
              }),
              new Paragraph({
                text: `${actaData.REFERENCIA.acuerdo} - ${numeroRef} - ${actaData.REFERENCIA.anno}`,
                alignment: AlignmentType.CENTER,
              }),
              new Paragraph({
                text: moment(fechaCreacion).format(`D [de] MMMM [de] YYYY`),
                alignment: AlignmentType.CENTER,
              }),
              new Paragraph({
                text: `ACTA: ${estado}`,
                alignment: AlignmentType.END,
              }),
            ],
          }),
        },
        footers: {
          default: new Footer({
            children: [
              firma,
              new Paragraph({
                alignment: AlignmentType.END,
                children: [
                  new TextRun({
                    children: ["Page Number: ", PageNumber.CURRENT],
                  }),
                  new TextRun({
                    children: [" to ", PageNumber.TOTAL_PAGES],
                  }),
                ],
              }),
            ],
          }),
        },
        children: [
          // CREAMOS PARRAFOS INDEPENDIENTES
          new Paragraph({
            text: `${actaData.PROLOGO.descAntesDeLaFecha} ${actaData.NOMBRE_INSTITUCION}, reunidos el ${fechaCreacionPrologoFormat}, de manera ${modalidad} en el ${lugarTexto} de la Facultad de Ingeniería, ${actaData.PROLOGO.desDespuesFecha}, sesionó de ${horaInicioFormat} - ${horaFinalFormat}, ${actaData.PROLOGO.desFinal}`,
            alignment: AlignmentType.JUSTIFIED,
          }),
          new Paragraph({
            text: `ACTA NUMERO ${numeroRef}`,
            alignment: AlignmentType.CENTER,
            heading: HeadingLevel.HEADING_4, // ASIGNAMOS ESTE PARRAFO COMO UN ENCABEZADO PRINCIPAL
            style: {
              color: "000000",
            },
          }),

          new Paragraph({
            text: "MIEMBROS PRESENTES",
            heading: HeadingLevel.HEADING_2,
            alignment: AlignmentType.CENTER,
            style: {
              paragraph: {
                color: "000000",
              },
            },
          }),
          // table,
          tablePresent,
          new Paragraph({
            text: "MIEMBROS AUSENTES",
            heading: HeadingLevel.HEADING_2,
            alignment: AlignmentType.CENTER,
            style: {
              paragraph: {
                color: "000000",
              },
            },
          }),
          // table,
          tableAusent,
          new Paragraph({
            text: "MIEMBROS INVITADOS",
            heading: HeadingLevel.HEADING_2,
            alignment: AlignmentType.CENTER,
            style: {
              paragraph: {
                color: "000000",
              },
            },
          }),
          tableInvit,
          new Paragraph({
            text: "CRONOGRAMA",
            heading: HeadingLevel.HEADING_2,
            alignment: AlignmentType.CENTER,
            style: {
              paragraph: {
                color: "000000",
              },
            },
          }),
          new Paragraph({
            text: `${cronograma}`,
            alignment: AlignmentType.JUSTIFIED,
            spacing: {
              line: 360, // Interlineado de 1.5 (1.5 * 12 puntos por línea = 18 puntos por línea)
            },
          }),
          new Paragraph({
            text: "RESUELVE",
            heading: HeadingLevel.HEADING_2,
            alignment: AlignmentType.CENTER,
            style: {
              paragraph: {
                color: "000000",
              },
            },
          }),
          ...parrafosArticulos.flat(),
        ],
      },
    ],
  });

  // GENERAR PDF Y ENVIARLO
  // const doc = new jsPDF();

  // ESCRIBE PRIMERA LINEA, ESTABLECE TAMAÑO DE FUENTE, COLOR, CONTENIDO Y POSICIÓN
  // doc.addImage(LogoUNAC, "PNG", 10, 10, 50, 50, );
  // doc.setFontSize(18);
  // doc.text(actaData ? actaData.TITULO : "...", 50, 10);
  // doc.setFontSize(12);
  // doc.text(actaData ? actaData.SUBTITULO : "...", 95, 15);
  // doc.setFontSize(12);
  // doc.text(
  //   actaData
  //     ? `${actaData.REFERENCIA.acuerdo} - ${numeroRef} - ${actaData.REFERENCIA.anno}`
  //     : "...",
  //   90,
  //   25
  // );
  // doc.text(moment(fechaCreacion).format(`D [de] MMMM [de] YYYY`), 90, 30);

  // doc.setFontSize(12);
  // doc.text(
  //   `${actaData.PROLOGO.descAntesDeLaFecha} ${actaData.NOMBRE_INSTITUCION},
  //   reunidos el ${fechaCreacionPrologoFormat} en el ${lugarTexto}, ${actaData.PROLOGO.desDespuesFecha},
  //   sesionó de ${horaInicioFormat} - ${horaFinalFormat}, ${actaData.PROLOGO.desFinal}`,
  //   10,
  //   40
  // );
  //   const contenidoTexto = `${actaData.PROLOGO.descAntesDeLaFecha} ${actaData.NOMBRE_INSTITUCION},
  // reunidos el ${fechaCreacionPrologoFormat} en el ${lugarTexto}, ${actaData.PROLOGO.desDespuesFecha},
  // sesionó de ${horaInicioFormat} - ${horaFinalFormat}, ${actaData.PROLOGO.desFinal}`;

  // Dividir el contenido en líneas
  // const lines = doc.splitTextToSize(
  //   contenidoTexto,
  //   doc.internal.pageSize.getWidth() - 20
  // );

  // Agregar las líneas de texto
  // doc.text(lines, 10, 40);

  // doc.setFontSize(12);
  // doc.text("Miembros Presentes:", 10, 70);
  // doc.text(miembrosPresentes, 20, 70);
  // doc.setFontSize(12);
  // doc.text("Miembros Ausentes:", 10, 80);
  // doc.text(miembrosPresentes, 20, 70);
  // doc.setFontSize(12);
  // doc.text("Miembros Invitados:", 10, 90);
  // doc.text(miembrosPresentes, 20, 70);

  // doc.setFontSize(12);
  // doc.text("DESARROLLO DEL ORDEN DEL DIA", 50, 100);
  // const ordenDelDia = [
  //   "1. Apertura de la reunión:",
  //   "[Descripción del primer punto]",
  //   "2. Lectura y aprobación del acta anterior:",
  //   "[Descripción del segundo punto]",
  //   // ... agregar más puntos del orden del día
  // ];
  // doc.text(ordenDelDia, 20, 110);

  // Agregar más contenido siguiendo el mismo patrón

  // doc.setFontSize(12);
  // doc.text(`________________________`, 30, 250);
  // doc.text(`${actaData.FIRMAS.JFNM.nombre}`, 30, 255);
  // doc.text(`${actaData.FIRMAS.JFNM.cargo}`, 30, 260);
  // doc.text(`________________________`, 100, 250);
  // doc.text(`${actaData.FIRMAS.OJD.nombre}`, 100, 255);
  // doc.text(`${actaData.FIRMAS.OJD.cargo}`, 100, 260);

  // doc.addPage();
  // doc.setFontSize(16);
  // doc.setTextColor(18, 47, 117);
  // doc.text(`Número de Referencia: ${numeroRef}`, 5, 20);

  // doc.setFontSize(24);
  // doc.setTextColor(100);
  // doc.text(`Lugar del acta: ${lugar}`, 5, 40);

  // GUARDA EL PDF EN LA CARPETA TEMPORAL
  // doc.save(`src/temp/acta_ref_${numeroRef}.pdf`);

  const rootPath = (refFile) => {
    return path.join(process.cwd(), `src/temp/acta_ref_${refFile}.pdf`);
  };

  // Documentos de soporte
  let statMsg;

  async function folderExists(folderPath) {
    try {
      const stats = await fs.stat(folderPath);
      return stats.isDirectory();
    } catch (err) {
      if (err.code === "ENOENT") {
        return false; // La carpeta no existe
      }
      throw err; // Ocurrió un error diferente
    }
  }

  async function getActaFiles(ref) {
    const folderPath = path.join(
      process.cwd(),
      `src/uploads/actas/docs-soportes/soportes_ref_${ref}`
    );

    if (await folderExists(folderPath)) {
      statMsg = "Se envía el acta junto a sus documentos de soporte";
      return fs.readdir(folderPath).then((files) => {
        return files.map((file) => ({
          filename: file,
          path: path.join(folderPath, file),
        }));
      });
    } else {
      statMsg =
        "El acta no cuenta con documentos de soporte. Se envió el PDF generado en su lugar.";
      return [];
    }
  }

  const actaFiles = await getActaFiles(numeroRef);

  actaFiles.push({
    filename: `acta_ref_${numeroRef}.docx`,
    path: path.join(process.cwd(), `src/temp/acta_ref_${numeroRef}.docx`),
  });

  console.log(actaFiles);
  // console.log(actaFiles);

  // EMAIL OPTIONS

  const transporter = nodemailer.createTransport({
    service: "gmail",
    auth: {
      user, // correo principal o de pruebas
      pass, // contraseña generada en google
    },
  });

  const mailOptions = {
    from: `<${user}>`,
    to: toArr,
    subject,
    text: bodyEmail,
    html: `
      <h1>Correo enviado desde nodemailer para ${to}</h1>
       <h3>Se lo mandó la persona: ${name}</h3>
      <p>${bodyEmail}</p>
      <span style="color: #908890;font-size: 16px; font-weight: bold;">
      NOTA: Favor no responder a este mensaje, debido a que es un correo de divulgación, 
      cualquier inquietud o duda que tenga envíela al correo de la persona o departamento al que se hace mención.
      </span>

    <div style="background-color: #ffffff; padding: 20px;">
        <p style="color: #333;">Gracias por su atención.</p>
        <p style="color: #333;">Saludos cordiales, ${name}</p>
    </div>
  `,
    // DOCUMENTO ADJUNTO UBICADO EN root/src/temp/acta_ref_?.pdf y root/src/
    attachments: actaFiles,
  };

  try {
    Packer.toBuffer(doc).then((buffer) => {
      fss.writeFileSync(`src/temp/acta_ref_${numeroRef}.docx`, buffer);
    });

    transporter.sendMail(mailOptions, (err, info) => {
      err
        ? console.log(err)
        : console.log("Email enviado correctamente." + " " + statMsg);
    });

    // Actualizada la respuesta, añadiendo el estado de los documentos de soporte
    res.send({ message: "Enviado correctamente", stat: statMsg });
  } catch (e) {
    console.error(e);
  }
};
